<!DOCTYPE HTML>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/splash/splash-icon.png">
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen.png" media="screen and (max-device-width: 320px)" />
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen@2x.png" media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" sizes="640x1096" href="images/splash/splash-screen@3x.png" />
    <link rel="apple-touch-startup-image" sizes="1024x748" href="images/splash/splash-screen-ipad-landscape"
        media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
    <link rel="apple-touch-startup-image" sizes="768x1004" href="images/splash/splash-screen-ipad-portrait.png"
        media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
    <link rel="apple-touch-startup-image" sizes="1536x2008" href="images/splash/splash-screen-ipad-portrait-retina.png"
        media="(device-width: 768px)  and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" sizes="1496x2048" href="images/splash/splash-screen-ipad-landscape-retina.png"
        media="(device-width: 768px) and (orientation: landscape)    and (-webkit-device-pixel-ratio: 2)" />
    <title>SAPCO - Siempres a tu lado</title>
    <link href="styles/style.css" rel="stylesheet" type="text/css">
    <link href="styles/framework.css" rel="stylesheet" type="text/css">
    <link href="styles/owl.carousel.css" rel="stylesheet" type="text/css">
    <link href="styles/owl.theme.css" rel="stylesheet" type="text/css">
    <link href="styles/swipebox.css" rel="stylesheet" type="text/css">
    <link href="styles/colorbox.css" rel="stylesheet" type="text/css">
	
	<link rel="stylesheet" type="text/css" media="all" href="jsdatepicker/jsDatePick_ltr.min.css" />
	
    <script type="text/javascript" src="scripts/jquery.js"></script>
    <script type="text/javascript" src="scripts/jqueryui.js"></script>
    <script type="text/javascript" src="scripts/owl.carousel.min.js"></script>
    <script type="text/javascript" src="scripts/jquery.swipebox.js"></script>
    <script type="text/javascript" src="scripts/colorbox.js"></script>
    <script type="text/javascript" src="scripts/snap.js"></script>
    <script type="text/javascript" src="scripts/contact.js"></script>
    <script type="text/javascript" src="scripts/custom.js"></script>
    <script type="text/javascript" src="scripts/framework.js"></script>
    <script type="text/javascript" src="scripts/framework.launcher.js"></script>
    <script type="text/javascript" src="http://pajhome.org.uk/crypt/md5/2.2/md5-min.js"></script>
    <script type="text/javascript" src="scripts/bd.js"></script>
	
	<script type="text/javascript" src="jsdatepicker/jsDatePick.full.1.3.js"></script>
	
</head>
<body>
    <div id="preloader">
        <div id="status">
            <p class="center-text">
                Cargando contenido... <em>La carga depende de su conexión a internet!</em>
            </p>
        </div>
    </div>
    <div class="all-elements">
         <div id="sidebar" class="page-sidebar">
            <div class="page-sidebar-scroll">
                <div class="sidebar-shortcuts">
                    <a href="#" class="shortcut-close"></a>
                </div>
                
                <div class="sidebar-search">
                    <div class="search-box">
                        <input type="text" class="search-field" name="search" onfocus="if(this.value == 'Looking for something?') { this.value = ''; }" value="Looking for something?">
                        <a href="#" class="search-close"></a>
                    </div>
                </div>
                
                <div class="sidebar-logo">
                    <img src="images/drugs/logo_odc.png" height="80" alt="img">
                </div>
                
                <div class="sidebar-breadcrumb">NAVEGACIÓN</div>                
                <div class="sidebar-decoration"></div>
                <div class="navigation-item">
                    <a href="index.html" class="nav-item home-icon">Nueva sesión<em class="selected-item"></em></a>	
                </div>
				<div class="sidebar-decoration"></div>
                <div class="navigation-item">
                   <a href="infoclientes.html" class="nav-item home-icon">Mis datos personales<em class="selected-item"></em></a>
                </div>	
				
				<div class="sidebar-decoration"></div>
                <div class="navigation-item">
                   <a href="infovehiculos.html" class="nav-item home-icon">Mis vehículos<em class="selected-item"></em></a>
                </div>	
                <div class="sidebar-decoration"></div>				
                <div class="sidebar-breadcrumb">
                </div>
            </div>         
        </div>
     
        <div id="content" class="page-content">
            <div class="page-header">
                <a href="#" class="deploy-sidebar"></a>
                <img class="header-logo" src="images/drugs/odc-texto.png" width="71" alt="img">
            </div>
            <div class="page-header-clear">
            </div>
            <div class="content">
                <div class="decoration">
                </div>
				<div class="container no-bottom" style="text-align: center;">
                    <h3>
                        ACTUALIZA TU INFORMACIÓN PERSONAL</h3>
                </div>
                <div class="decoration">
                </div>
                <div class="container no-bottom">
                    <div class="big-notification blue-notification">
                        <h4 class="uppercase">
                            Actualiza tu información regularmente</h4>
                        <a href="#" class="close-big-notification">x</a>
                        <p>
                            Para un mejor servicio, recuerda actualizar tu<br/>
							información personal de manera regular.<br/>
						</p>
                    </div>
                </div>
               
                <br />
                <div class="container no-bottom">
                    <form method="post" class="contactForm" id="contactForm" style="display: block !important;">
                    <fieldset>
                        <div class="formValidationError" id="usuario_error">
                            <div class="static-notification-red tap-dismiss-notification">
                                <p class="center-text uppercase">
                                    Debe ingresar el nombre de usuario</p>
                            </div>
                        </div>
                        <div class="formValidationError" id="password_error">
                            <div class="static-notification-red tap-dismiss-notification">
                                <p class="center-text uppercase">
                                    Debe ingresar la contraseña</p>
                            </div>
                        </div>
						<div id="info-cliente">
						</div>
						
						<br />
                        <!--
						<div class="formSubmitButtonErrorsWrap">
                            <input type="submit" class="buttonWrap button button-dark contactSubmitButton" id="contactSubmitButton"
                                value="Enviar" data-formid="contactForm" onclick="iniciar_sesion();" />
                            <div class="static-notification-green tap-dismiss-notification" style="display: none; margin-top: 15px;" id="div_guardado">
                                <p class="center-text">Los datos han sido almacenados correctamente</p>
                            </div>
                        </div>
						-->
                    </fieldset>
                    </form>
                </div>
                <div class="decoration">
                </div>
                <div id="loading" class="CargandoModalBackground">
                    <img src="images/bx_loader.gif" alt="loding" class="CargandoModalBackgroundImage" />
                </div>
                <div class="container">
                    <div class="footer-socials">
                        <a href=https://www.facebook.com/sapco.co class="facebook-footer"></a><a href="#" class="goup-footer"></a><a href="#"
                            class="twitter-footer"></a>
                    </div>
                   <p class="copyright uppercase center-text no-bottom">SAPCO 2014<br> Todos los derechos reservados</p>      
                </div>
            </div>
        </div>
        
    </div>
    <script type="text/javascript">
      
	  function jsdatepickerload(){
		new JsDatePick({
			useMode:2,
			target:"FechaNacimientoField",
			dateFormat:"%Y-%m-%d",
			imgPath:"jsdatepicker/img/",
			/*selectedDate:{				This is an example of what the full configuration offers.
				day:5,						For full documentation about these settings please see the full version of the code.
				month:9,
				year:2006
			},
			yearsRange:[1978,2030],
			limitToToday:false,
			cellColorScheme:"beige",
			dateFormat:"%m-%d-%Y",
			imgPath:"img/",
			weekStartDay:1*/
		});
	}
        
        function closedSession(){
		    sessionStorage.setItem("idUsuario", 0);
			location.href = "index.html";
		} 
        
		$( document ).ready(function() {
		  if(sessionStorage.getItem("idUsuario") == 0){			  			 
			  location.href = "index.html";			  
		  }else{		        
				InfoClientesEditable();
			}
        });
		
		var cliente = {Apellidos:"", Correo:"", Direccion:"", DocIdentidad:"", FechaNacimiento:"", FechaVenceLicencia:"", Nombre:"", Telefono:"", TipoDocId:""};
        var clientes = [];
		function InfoClientesEditable(){                    
				var texto="";
				if(sessionStorage.getItem("idUsuario") != 0 ){	               
                var url = "https://sgc.solucionesglobalessa.com:50004/Service1.svc/getInfoUsuario?idUsuario="+sessionStorage.getItem("idUsuario");
                    $.ajax({
                        url: url,
                        type: 'GET',
                        dataType: 'json',
                        crossDomain: true,
                        success: function (data) {

                            $.each(data, function (i, field) {                                
                                $.each(field, function (x, item) {									
									
									texto+='<div class="formFieldWrap"><label class="field-title NombreField" for="NombreField">Nombre: <span>(requerido)</span></label><input type="text" name="NombreField" value="'+field[x].Nombre+ '" class="contactField requiredField" id="NombreField" />'+
								           '<div class="formFieldWrap"><label class="field-title ApellidosField" for="ApellidosField">Apellidos: <span>(requerido)</span></label><input type="text" name="ApellidosField" value="'+field[x].Apellidos+ '" class="contactField requiredField" id="ApellidosField" />'+
									       '<div class="formFieldWrap"><label class="field-title TelefonoField" for="TelefonoField">Teléfono:</label><input type="text" name="TelefonoField" value="'+field[x].Telefono+ '" class="contactField requiredField" id="TelefonoField" />'+
										   '<div class="formFieldWrap"><label class="field-title CedulaField" for="CedulaField">Cédula:</label><input type="text" name="CedulaField" value="'+field[x].DocIdentidad+ '" class="contactField requiredField" id="CedulaField" />'+
									       '<div class="formFieldWrap"><label class="field-title DireccionField" for="DireccionField">Dirección:</label><input type="text" name="DireccionField" value="'+field[x].Direccion+ '" class="contactField requiredField" id="DireccionField" />'+
									       '<div class="formFieldWrap"><label class="field-title FechaNacimientoField" for="FechaNacimientoField">Fecha de Nacimiento (YYYY-MM-DD):</label><input type="text" name="FechaNacimientoField" value="'+ convertirFecha(field[x].FechaNacimiento) + '" class="contactField requiredField" id="FechaNacimientoField" onfocus="jsdatepickerload;"/>'+
									       '<div class="formFieldWrap"><label class="field-title CorreoField" for="CorreoField">Correo:</label><input type="email" name="CorreoField" value="'+field[x].Correo+ '" class="contactField requiredField" id="CorreoField" />'+
									       '<div class="formFieldWrap"><label class="field-title FechaVenceLicenciaField" for="FechaVenceLicenciaField">Fecha de vencimiento de licencia (YYYY-MM-DD): </label><input type="text" name="FechaVenceLicenciaField" value="'+convertirFecha(field[x].FechaVenceLicencia) + '" class="contactField requiredField" id="FechaVenceLicenciaField" />'+
									       '<br /><input type="button" class="buttonWrap button button-dark contactSubmitButton" id="contactSubmitButton" value="Actualizar" onclick="ActualizarInfoClientesEditable('+localStorage.getItem("idUsuario")+');" /><br /></div></div></div></div></div>';
                                });
                                
                            });
							document.getElementById("info-cliente").innerHTML = texto;
							$('.deploy-toggle-2').click(function () {
							$(this).parent().find('.toggle-content').toggle(100);
							$(this).toggleClass('toggle-2-active');
							return false;
							});
                        },
                        error: function (x, y, z) {
                            //OcultarDivCargando();
                        }, 
                        timeout: 15000                          
                    });
					
				}else{
				  alert("El codigo de usurio se ha perdido, para poder visualizar la información por favor loguearse de nuevo en el sistema");
				}
        }
		
		
	
	
		
		
		function ActualizarInfoClientesEditable(codCliente) {

           var nombre = $('#NombreField').val();
            var apellidos = $('#ApellidosField').val();
            var	telefono = $('#TelefonoField').val();
			var	docidentidad= $('#CedulaField').val();	
			var	direccion = $('#DireccionField').val();	
			var	fechanacimiento = $('#FechaNacimientoField').val();	
			var	correo = $('#CorreoField').val();	
			var	fechavencelicencia = $('#FechaVenceLicenciaField').val();
			if(nombre == ""){
                alert("Debes ingresar tu nombre");
				return;
            }
            else{
                if(apellidos == ""){
                    alert("Debes ingresar tus apellidos");
					return;
                }
				var isDate = esFechaValida(fechanacimiento);
				if(!isDate){
				    alert("La fecha de nacimiento no es válida. El Formato debe ser YYYY-MM-DD");
					return;
				}
				isDate=esFechaValida(fechavencelicencia);
				if(!isDate){
					alert("La fecha de vencimiento de licencia no es válida. El Formato debe ser YYYY-MM-DD");
					return;
				}
				if(fechanacimiento =="" || fechavencelicencia==""){
				      alert("Debes ingresar las fechas solicitadas");
					  return;
				
				}else{
					
					 var confirmar=confirm("¿Confirma que desea actualizar la información?");
					 if(confirmar){
					   
					   MostrarDivCargando();
						
					   var url = encodeURI("https://sgc.solucionesglobalessa.com:50004/Service1.svc/setInfoUsuario?idUsuario="+sessionStorage.getItem("idUsuario")+"&nombre="+nombre+"&apellidos="+apellidos+"&telefono="+telefono+"&docidentidad="+docidentidad+"&direccion="+direccion+"&fechaNacimiento="+fechanacimiento+"&correo="+correo+"&fechavencelicencia="+fechavencelicencia);
						$.ajax({
							url: url,
							type: 'GET',
							dataType: 'json',
							crossDomain: true,
							success: function (data) {

								$.each(data, function (i, field) {

									$.each(field, function (x, item) {

										if(field[x].Codusua == 0){
											OcultarDivCargando();
											alert(field[x].Mensaje);
										}
										else{
											if(field[x].Codusua==sessionStorage.getItem("idUsuario")) {
											OcultarDivCargando();
											alert(field[x].Mensaje); 										
											location.href = "infoclientes.html";
											}
										}
									});

								});
							},
							error: function (x, y, z) {
								alert("No se encuentra una conexión 3G o Wifi activa o el servidor está ocupado")
								OcultarDivCargando();
							}, 
							timeout: 15000                          
						});
					}
                }
            }
        }

        
        function errorGeneralBD(err){ 
            console.log(err);
        }
		
		function esFechaValida(date) {
                             return (new Date(date) !== "Invalid Date" && !isNaN(new Date(date)) )? true : false;
		}
		
		function convertirFecha(oldfecha){
			
			var valores=oldfecha.replace(' 12:00:00 AM','').split("/");
			
			if(valores[1].length==1){
			
			valores[1]="0"+valores[1];
			}
			
			if(valores[0].length==1){
			
			valores[0]="0"+valores[0];
			}
			return valores[2]+"-"+valores[0]+"-"+valores[1];
		
		}

        
    </script>
    <style>
        #contactNameField {
            text-transform: none;
        }

        .submenu-nav-items a
        {
            padding-left: 20px !important;
            padding-top: 10px !important;
            padding-bottom: 10px !important;
            border-bottom: solid 1px rgba(0,0,0,0.1) !important;
        }
        
        .vinculo_derecha
        {
            float: right;
            padding-right: 1%;
        }
        
        .vinculo_izquierda
        {
            float: left;
            padding-left: 1%;
            display: none;
        }
        
        .CargandoModalBackground
        {
            overflow: hidden;
            background-color: #0D0D0D;
            filter: alpha(opacity=90);
            opacity: 0.9;
            position: fixed;
            top: 0px;
            left: 0px;
            text-align: center;
            vertical-align: middle;
            width: 100%;
            height: 100%;
            display: none;
            z-index: 9999;
            color: white;
            text-align: left;
        }
        
        .styled-select
        {
            width: 95%;
            height: 34px;
            overflow: hidden;
            background: url(images/flecha_abajo.png) no-repeat right #F4F4F4;
            padding: 3px;
            margin: 5px;
            -webkit-border-radius: 4px;
            -moz-border-radius: 4px;
            border-radius: 4px;
            -webkit-box-shadow: 0 3px 0 #ccc, 0 -1px #fff inset;
            -moz-box-shadow: 0 3px 0 #ccc, 0 -1px #fff inset;
            box-shadow: 0 3px 0 #ccc, 0 -1px #fff inset;
            color: #888;
            border: none;
            outline: none;
            display: inline-block;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            cursor: pointer;
        }
    </style>
</body>
</html>